package com.lianjia.profiling.bench

import com.lianjia.profiling.common.elasticsearch.ESClient
import org.apache.spark.{SparkConf, SparkContext}
import org.elasticsearch.action.get.{GetAction, GetRequestBuilder}
import org.elasticsearch.action.search.{SearchAction, SearchRequestBuilder}
import org.elasticsearch.index.query.QueryBuilders
import org.elasticsearch.index.query.QueryBuilders.termQuery

/**
  * @author fenglei@lianjia.com on 2016-06
  */

object Bench extends App with ESClient  {

  val hdfsUri = "hdfs://jx-bd-hadoop00.lianjia.com:9000"

  val conf = new SparkConf().setAppName("bench").setMaster("local[1]")
  val sc = new SparkContext(conf)

  val data = sc.textFile("/user/bigdata/profiling/bench/ucid0626", 15)

  val startMs = System.currentTimeMillis()

  val count = data.count()

  def phoneKV() = {
    data mapPartitions { part =>
      val client = getClient
      var before: Long = 0
      part map { phone =>
        before = System.currentTimeMillis()

        val resp = new GetRequestBuilder(client, GetAction.INSTANCE)
        .setIndex("customer")
        .setType("customer")
        .setId(phone)
        .get

        (System.currentTimeMillis() - before, resp.getSourceAsString.length)
      }
    }
  }

  def ucidSearch() = {
    data mapPartitions { part =>
      val client = getClient
      var before: Long = 0
      part map { ucid =>
        before = System.currentTimeMillis()


        val resp = new SearchRequestBuilder(client, SearchAction.INSTANCE)
                   .setIndices("online_user_20160620")
                   .setQuery(QueryBuilders.boolQuery().must(termQuery("ucid", ucid))
                             .must(QueryBuilders.rangeQuery("ts").gt(1466697600000L).lt(1466784000000L)))
                   .setSize(2000)
                   .get

        (System.currentTimeMillis() - before, resp.getHits.hits().map(_.getSourceAsString.length).sum)
      }
    }
  }

  def ucidSearchMultiIndices() = {
    data mapPartitions { part =>
      val client = getClient
      var before: Long = 0
      part map { ucid =>
        before = System.currentTimeMillis()

        val resp = new SearchRequestBuilder(client, SearchAction.INSTANCE)
                   .setIndices("online_user_20160613",
                               "online_user_20160606",
                               "online_user_20160530",
                               "online_user_20160523",

                               "online_user_20160516",
                               "online_user_20160509",
                               "online_user_20160502",
                               "online_user_20160425",

                               "online_user_20160418",
                               "online_user_20160411",
                               "online_user_20160404",
                               "online_user_20160328")
                   .setQuery(termQuery("ucid", ucid))
                   .setSize(2000)
                   .get

        (System.currentTimeMillis() - before, resp.getHits.hits().map(_.getSourceAsString.length).sum)
      }
    }
  }

  def phoneSearch() = {
    data mapPartitions { part =>
      val client = getClient
      var before: Long = 0
      part map { houseId =>
        before = System.currentTimeMillis()

        new SearchRequestBuilder(client, SearchAction.INSTANCE)
        .setIndices("customer")
        .setQuery("")
        .setSize(0)
        .get

        System.currentTimeMillis() - before
      }
    }
  }

  var bench = ucidSearch() collect()
  var delays = bench map (_._1) sorted
  var delays2 = bench sortBy (_._1)
  var sizes = bench map (_._2) sorted
  val len = delays.length

  val xx= // 13716039218
    """
      |{"data":[{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.045976,116.311708","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-17 12:42:42","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.045967,116.311839","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-15 19:56:25","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"setting_tab","location":"40.046032,116.311765","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-15 00:36:19","city_id":"北京"},{"ch_id":"新房","os_type":"1","event_name":"new_house","location":"40.046032,116.311765","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-15 00:36:19","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"setting_tab","location":"40.046032,116.311765","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-15 00:36:19","city_id":"北京"},{"keywords":"锐力领峰","city":"成都","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"CDSL92190648","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"首页","os_type":"1","location":"40.046635,116.429963","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"成都","timestamp":"2016-06-11 22:18:08"},{"ch_id":"首页","os_type":"1","event_name":"community_history","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"2nd_hand_house_detail","timestamp":"2016-06-11 22:18:08","city_id":"北京"},{"keywords":"锐力领峰","city":"成都","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"CDSL92190648","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"首页","os_type":"1","location":"40.046635,116.429963","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"成都","timestamp":"2016-06-11 22:18:08"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.046635,116.429963","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-06-11 22:18:08","city_id":"成都"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:08","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:08","city_id":"成都"},{"ch_id":"首页","os_type":"1","event_name":"look_my_house","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"host_owner_home_page","timestamp":"2016-06-11 22:18:08","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"setting_tab","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:08","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:08","city_id":"北京"},{"keywords":"锐力领峰","city":"成都","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"CDSL92190648","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"首页","os_type":"1","location":"40.046635,116.429963","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"成都","timestamp":"2016-06-11 22:18:08"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.046635,116.429963","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-06-11 22:18:08","city_id":"北京"},{"keywords":"黄庄小区","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJHD92346260","uuid":"868404027385025","search_position":11,"is_suggestion":0,"ch_id":"首页","os_type":"1","location":"40.046635,116.429963","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-06-11 22:18:08"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:08","city_id":"成都"},{"ch_id":"首页","os_type":"1","event_name":"message_tab","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"setting_tab","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"request_sms","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"login","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"sms_login","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"login","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"homepage_tab","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"login","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"self","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"sms_login_tab","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"login","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"normal_login_tab","location":"40.046635,116.429963","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"login","timestamp":"2016-06-11 22:18:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.06137,116.315934","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-05-09 22:22:56","city_id":"南京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.06137,116.315934","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-05-09 22:22:56","city_id":"北京"},{"keywords":"黄庄小区","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJHD88898143","uuid":"868404027385025","search_position":17,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.06137,116.315934","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-05-09 22:22:56"},{"attention_type":"二手房","attention_action":1,"attention_id":"BJHD88898143","os_type":"1","location":"40.06137,116.315934","event":"移动端关注","user":"2000000000566818","uuid":"868404027385025","timestamp":"2016-05-09 22:22:56"},{"city":"南京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"103100001336","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061327,116.31595","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"南京","timestamp":"2016-04-29 19:42:27"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061327,116.31595","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-29 19:42:27","city_id":"南京"},{"city":"天津","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"101090487691","uuid":"868404027385025","search_position":4,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061327,116.31595","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"天津","timestamp":"2016-04-29 19:42:27"},{"ch_id":"二手房","os_type":"1","event_name":"setting_tab","location":"40.061327,116.31595","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-29 19:42:27","city_id":"天津"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.061327,116.31595","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-29 19:42:27","city_id":"天津"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.061327,116.31595","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-29 19:42:26","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"message_tab","location":"40.061327,116.31595","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-29 19:42:26","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061327,116.31595","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-29 19:42:26","city_id":"天津"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061327,116.31595","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-29 19:42:26","city_id":"天津"},{"city":"天津","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"101085312451","uuid":"868404027385025","search_position":2,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061327,116.31595","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"天津","timestamp":"2016-04-29 19:42:26"},{"ch_id":"首页","os_type":"1","event_name":"homepage_tab","location":"40.061327,116.31595","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-29 19:42:26","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061279,116.315913","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 20:38:05","city_id":"北京"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":1,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061279,116.315913","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 20:38:05"},{"ch_id":"首页","os_type":"1","event_name":"baike","location":"40.061283,116.315914","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 20:26:48","city_id":"北京"},{"ch_id":"地图找房","os_type":"1","event_name":"sale_house","location":"40.061277,116.315914","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 18:43:27","city_id":"北京"},{"ch_id":"小区","os_type":"1","event_name":"community","location":"40.061277,116.315914","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 18:43:27","city_id":"北京"},{"ch_id":"地图找房","os_type":"1","event_name":"baike","location":"40.061277,116.315914","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 18:43:27","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061363,116.315916","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 13:57:44","city_id":"北京"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJFT91990693","uuid":"868404027385025","search_position":1,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061363,116.315916","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 13:57:41"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:14"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:14"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:14"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:11"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:11"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:11"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:11"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:11"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:11"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:11"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:10"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:10"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:10"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:10"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:10"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:10"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:10","city_id":"北京"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJXC91989222","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-27 12:02:10"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:09","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:09","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:09","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:09","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:07","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:07","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:06","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:06","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:05","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:04","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:03","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:03","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:03","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:02","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:02","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:01","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:00","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:02:00","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:59","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:58","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:57","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:57","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:57","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:57","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:56","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:55","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:55","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:55","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:55","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:54","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:54","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:54","city_id":"北京"},{"city":"北京","channel":"zufang","referer_page":"rent_house_list","detail_id":"BJCY91901266","uuid":"868404027385025","search_position":1,"is_suggestion":0,"ch_id":"租房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"rent_house_detail","city_id":"北京","timestamp":"2016-04-27 12:01:53"},{"city":"北京","channel":"zufang","referer_page":"rent_house_list","detail_id":"BJCY91901266","uuid":"868404027385025","search_position":1,"is_suggestion":0,"ch_id":"租房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"rent_house_detail","city_id":"北京","timestamp":"2016-04-27 12:01:53"},{"city":"北京","channel":"zufang","referer_page":"rent_house_list","detail_id":"BJCY91901266","uuid":"868404027385025","search_position":1,"is_suggestion":0,"ch_id":"租房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"rent_house_detail","city_id":"北京","timestamp":"2016-04-27 12:01:51"},{"city":"北京","channel":"zufang","referer_page":"rent_house_list","detail_id":"BJCY91901266","uuid":"868404027385025","search_position":1,"is_suggestion":0,"ch_id":"租房","os_type":"1","location":"40.061292,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"rent_house_detail","city_id":"北京","timestamp":"2016-04-27 12:01:51"},{"ch_id":"租房","os_type":"1","event_name":"rent_house","location":"40.061292,116.315917","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-27 12:01:50","city_id":"北京"},{"city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJTJ91906979","uuid":"868404027385025","search_position":5,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061287,116.315917","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-26 09:52:29"},{"max_area":"110","keywords":"北苑家园茉藜园","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJCY92007572","uuid":"868404027385025","search_position":1,"is_suggestion":0,"min_area":"90","ch_id":"首页","os_type":"1","location":"40.061284,116.315916","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-26 09:51:46"},{"max_area":"110","keywords":"北苑家园茉藜园","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJCY92007572","uuid":"868404027385025","search_position":1,"is_suggestion":0,"min_area":"90","ch_id":"首页","os_type":"1","location":"40.061284,116.315916","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-26 09:51:46"},{"max_area":"110","keywords":"北苑家园茉藜园","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJCY92015328","uuid":"868404027385025","search_position":2,"is_suggestion":0,"min_area":"90","ch_id":"首页","os_type":"1","location":"40.061284,116.315916","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-26 09:51:46"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.061284,116.315916","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-26 09:51:43","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061285,116.315916","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-26 09:47:19","city_id":"北京"},{"max_area":"110","keywords":"北苑家园茉藜园","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJCY91777958","uuid":"868404027385025","search_position":6,"is_suggestion":0,"min_area":"90","ch_id":"首页","os_type":"1","location":"40.061358,116.315929","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-25 17:54:24"},{"ch_id":"首页","os_type":"1","event_name":"photo_preview","location":"40.061358,116.315929","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"2nd_hand_house_detail","timestamp":"2016-04-25 17:54:24","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061358,116.315929","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 17:54:24","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.061358,116.315929","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 17:54:24","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061362,116.315939","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 17:37:56","city_id":"北京"},{"max_area":"110","keywords":"北苑家园茉藜园","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJCY91777958","uuid":"868404027385025","search_position":6,"is_suggestion":0,"min_area":"90","ch_id":"首页","os_type":"1","location":"40.061362,116.315939","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-25 17:37:56"},{"max_area":"110","keywords":"北苑家园茉藜园","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJCY91777958","uuid":"868404027385025","search_position":6,"is_suggestion":0,"min_area":"90","ch_id":"首页","os_type":"1","location":"40.061362,116.315939","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-25 17:37:56"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.061362,116.315939","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 17:37:56","city_id":"北京"},{"sug_position":-1,"ch_id":"二手房","os_type":"1","location":"40.061456,116.315903","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 17:12:52","city_id":"北京"},{"sug_position":-1,"ch_id":"二手房","os_type":"1","location":"40.061456,116.315903","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 17:12:52","city_id":"北京"},{"sug_position":-1,"ch_id":"二手房","os_type":"1","location":"40.061456,116.315903","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 17:12:52","city_id":"北京"},{"sug_position":-1,"ch_id":"二手房","os_type":"1","location":"40.061456,116.315903","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 17:12:52","city_id":"北京"},{"sug_position":-1,"ch_id":"二手房","os_type":"1","location":"40.061456,116.315903","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 17:12:51","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"keyword_search","location":"40.061456,116.315903","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 17:12:51","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061456,116.315903","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 17:12:51","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061323,116.315935","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 16:15:50","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061278,116.315916","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 15:51:07","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.061278,116.315916","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:51:06","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"setting_tab","location":"40.061276,116.315912","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:43:20","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061276,116.315912","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 15:43:20","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.061276,116.315912","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:43:20","city_id":"北京"},{"is_suggestion":0,"sug_position":-1,"city":"北京","ch_id":"首页","os_type":"1","location":"40.061276,116.315912","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"搜索栏","timestamp":"2016-04-25 15:43:18","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"setting_tab","location":"40.061276,116.315912","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:43:18","city_id":"北京"},{"max_area":"110","city":"北京","search_source":"搜索栏","uuid":"868404027385025","sug_position":-1,"is_suggestion":0,"min_area":"90","ch_id":"首页","os_type":"1","location":"40.061276,116.315912","event":"移动端搜索","user":"2000000000566818","timestamp":"2016-04-25 15:43:18","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061276,116.315912","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 15:43:18","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061276,116.315912","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 15:43:17","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.061276,116.315912","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:43:17","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061274,116.315914","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 15:25:47","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.061274,116.315914","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:25:46","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061279,116.315914","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:13:24","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061285,116.315912","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:05:21","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061274,116.315912","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 15:04:19","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061274,116.315912","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:04:19","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.061274,116.315912","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:04:19","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.061274,116.315912","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-25 15:04:19","city_id":"南京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.061274,116.315912","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-25 15:04:19","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"city_select","location":"40.061277,116.315915","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-21 19:08:20","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"enter_shopping_cart_click","location":"40.061277,116.315915","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"2nd_hand_house_detail","timestamp":"2016-04-21 19:08:20","city_id":"南京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061277,116.315915","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-21 19:08:20","city_id":"南京"},{"city":"南京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"103089672884","uuid":"868404027385025","search_position":0,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061277,116.315915","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"南京","timestamp":"2016-04-21 19:08:20"},{"is_suggestion":0,"sug_position":-1,"city":"北京","ch_id":"二手房","os_type":"1","location":"40.061277,116.315915","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"搜索栏","timestamp":"2016-04-21 19:08:20","city_id":"北京"},{"ch_id":"二手房","os_type":"1","event_name":"2nd_hand_house","location":"40.061277,116.315915","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-21 19:08:20","city_id":"北京"},{"city":"南京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"103088966959","uuid":"868404027385025","search_position":6,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061277,116.315915","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"南京","timestamp":"2016-04-21 19:08:20"},{"keywords":"黄庄小区","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJHD89939661","uuid":"868404027385025","search_position":2,"is_suggestion":0,"ch_id":"二手房","os_type":"1","location":"40.061277,116.315915","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-21 19:08:20"},{"keywords":"黄庄小区","city":"北京","channel":"ershoufang","referer_page":"2nd_hand_house_list","detail_id":"BJHD88898143","uuid":"868404027385025","search_position":15,"is_suggestion":0,"ch_id":"首页","os_type":"1","location":"40.046434,116.430012","event":"移动端详情页","user":"2000000000566818","detail_id_type":"房源","is_search":1,"current_page":"2nd_hand_house_detail","city_id":"北京","timestamp":"2016-04-19 09:11:27"},{"ch_id":"首页","os_type":"1","event_name":"community_history","location":"40.046434,116.430012","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"2nd_hand_house_detail","timestamp":"2016-04-19 09:11:27","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"keyword_search","location":"40.046434,116.430012","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-19 09:11:27","city_id":"北京"},{"sug_position":-1,"ch_id":"首页","os_type":"1","location":"40.046434,116.430012","event":"移动端搜索","user":"2000000000566818","uuid":"868404027385025","search_source":"其他(0)","timestamp":"2016-04-19 09:11:27","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"login","location":"40.061306,116.315921","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"self","timestamp":"2016-04-16 13:23:16","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"login","location":"40.061306,116.315921","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"login","timestamp":"2016-04-16 13:23:16","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"normal_login_tab","location":"40.061306,116.315921","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"login","timestamp":"2016-04-16 13:23:16","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"homepage_tab","location":"40.061306,116.315921","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-16 13:23:16","city_id":"南京"},{"ch_id":"首页","os_type":"1","event_name":"setting_tab","location":"40.061306,116.315921","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-16 13:23:16","city_id":"北京"},{"ch_id":"首页","os_type":"1","event_name":"city_select","location":"40.061306,116.315921","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"homepage","timestamp":"2016-04-16 13:23:16","city_id":"南京"},{"ch_id":"首页","os_type":"1","event_name":"judge_agent","location":"40.061306,116.315921","event":"移动端点击","user":"2000000000566818","uuid":"868404027385025","current_page":"my_house_visit_record","timestamp":"2016-04-16 13:23:16","city_id":"北京"}],"num":166,"page_no":0,"page_size":200}
    """.stripMargin

  xx.length  // 45893


  println(s"10%: ${sizes((len * 0.1).asInstanceOf[Int])}")
  println(s"20%: ${sizes((len * 0.2).asInstanceOf[Int])}")
  println(s"30%: ${sizes((len * 0.3).asInstanceOf[Int])}")
  println(s"50%: ${sizes((len * 0.5).asInstanceOf[Int])}")
  println(s"70%: ${sizes((len * 0.7).asInstanceOf[Int])}")
  println(s"90%: ${sizes((len * 0.9).asInstanceOf[Int])}")
  println(s"95%: ${sizes((len * 0.95).asInstanceOf[Int])}")
  println(s"99%: ${sizes((len * 0.99).asInstanceOf[Int])}")
  println(s"99.9%: ${sizes((len * 0.999).asInstanceOf[Int])}")
  println(s"100%: ${sizes(len - 1)}")

  println(s"10%:    ${delays((len * 0.1).asInstanceOf[Int])}")
  println(s"20%:    ${delays((len * 0.2).asInstanceOf[Int])}")
  println(s"30%:    ${delays((len * 0.3).asInstanceOf[Int])}")
  println(s"50%:    ${delays((len * 0.5).asInstanceOf[Int])}")
  println(s"70%:    ${delays((len * 0.7).asInstanceOf[Int])}")
  println(s"75%:    ${delays((len * 0.75).asInstanceOf[Int])}")
  println(s"80%:    ${delays((len * 0.8).asInstanceOf[Int])}")
  println(s"90%:    ${delays((len * 0.9).asInstanceOf[Int])}")
  println(s"95%:    ${delays((len * 0.95).asInstanceOf[Int])}")
  println(s"97%:    ${delays((len * 0.97).asInstanceOf[Int])}")
  println(s"98%:    ${delays((len * 0.98).asInstanceOf[Int])}")
  println(s"99%:    ${delays((len * 0.99).asInstanceOf[Int])}")
  println(s"99.5%:  ${delays((len * 0.995).asInstanceOf[Int])}")
  println(s"99.7%:  ${delays((len * 0.997).asInstanceOf[Int])}")
  println(s"99.8%:  ${delays((len * 0.998).asInstanceOf[Int])}")
  println(s"99.9%:  ${delays((len * 0.999).asInstanceOf[Int])}")
  println(s"100%:   ${delays(len - 1)}")

  val endMs = System.currentTimeMillis()

  println(s"start: $startMs, end: $endMs, count: $count.")

  sc.stop()
}
